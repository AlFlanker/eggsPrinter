<html xmlns:th="https://www.thymeleaf.org">
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
</head>
<body>
<nav class="navbar navbar-dark bg-primary">
    <div class="container">
        <a class="navbar-brand" href="#">Пасхальный принтер</a>
    </div>
</nav>
<script
        src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script>

    function uploadForm() {
        const $form = $("#uploadimage");
        const $file = $("#file_input");
        const $btn = $("#btn");
        const $spinner = $("#spinner");
        const formData = new FormData;
        formData.append('file', $file.prop('files')[0]);
        $.ajax({
            url: '/load-file',
            type: 'POST',
            data: formData,
            beforeSend: function () {
                $btn.prop('disabled', true);
                $spinner
                    .removeClass('d-none');
            },
            success: function (data) {
                $btn.prop('disabled', false);
                $spinner.addClass('d-none');
            },
            error: function () {
                $btn.prop('disabled', false);
                $spinner.addClass('d-none');
            },
            cache: false,
            contentType: false,
            processData: false
        });
    }
</script>
<div class="row justify-content-center">
    <div class="col-8">
        <div class="card" style="padding-top: 2em">
            <div th:if="${message}">
                <h2 th:text="${message}"/>
            </div>
            <div>

                <form  class="was-validated">
                    <table>
                        <tr>
                            <div class="custom-file">
                                <input type="file" id = file_input class="custom-file-input"  required>
                                <label class="custom-file-label" for="file_input">Выбери файл...</label>
                            </div>
                            </td>
                            <!--<td><input id = file_input class="form-control" type="file" name="file"/></td>-->
                        </tr>
                        <tr>
                            <td></td>
                            <!--<td><input type="submit" value="Загрузить"/></td>-->
                            <td><button type="button" id = btn class="btn btn-primary" onclick="uploadForm()">
                                <span class="spinner-grow spinner-grow-sm d-none" id = spinner role="status" aria-hidden="true"></span>
                                Загрузить
                            </button></td>
                        </tr>
                    </table>
                </form>

            </div>
            <div>
                <ul>
                    <li th:each="file : ${files}">
                        <a th:href="${file}" th:text="${file}"/>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

</body>
</html>
